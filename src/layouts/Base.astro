---
import "../styles.css";

const { title, frontmatter } = Astro.props;
const pageTitle = title || frontmatter?.title || "Peter Szathmary";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/png" href="/favicon_benny.png" />
    <title>{pageTitle}</title>
    <script is:inline>
      // Dark mode toggle
      const htmlEl = document.documentElement;
      const isDark = localStorage.getItem('dark-mode') === 'true' || 
                     (!localStorage.getItem('dark-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches);
      if (isDark) {
        htmlEl.classList.add('dark-mode');
      }
    </script>
  </head>
  <body>
    <header>
      <nav>
        <a href="/">Home</a>
        <ul>
          <li><a href="/experience/">Experience</a></li>
          <li><a href="/projects/">Projects</a></li>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="https://github.com/grobenek">GitHub</a></li>
          <li>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
              <span id="theme-icon"></span>
            </button>
          </li>
        </ul>
      </nav>
    </header>
    <main>
      <slot />
    </main>
    <footer>
      <p>The site follows noble ideas of the <a href="https://thebestmotherfucking.website/" target="_blank">thebestmotherf*cking.website</a> which more people should consider doing. The Internet would be a much more informative and pleasant experience.</p>
    </footer>
    <script is:inline>
      // Set icon immediately
      const iconEl = document.getElementById('theme-icon');
      const isDarkMode = document.documentElement.classList.contains('dark-mode');
      if (iconEl) {
        iconEl.textContent = isDarkMode ? 'â˜€ï¸' : 'ðŸŒ™';
      }
      
      // Theme toggle handler
      const toggle = document.getElementById('theme-toggle');
      const html = document.documentElement;
      
      toggle.addEventListener('click', () => {
        html.classList.toggle('dark-mode');
        const isDark = html.classList.contains('dark-mode');
        localStorage.setItem('dark-mode', isDark ? 'true' : 'false');
        iconEl.textContent = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
      });

      // Open external links in new tab
      document.querySelectorAll('a').forEach(link => {
        if (link.hostname && link.hostname !== window.location.hostname) {
          link.target = '_blank';
          link.rel = 'noopener noreferrer';
        }
      });
    </script>
  </body>
</html>
